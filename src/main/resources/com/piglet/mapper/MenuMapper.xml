<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.piglet.mapper.MenuMapper">    <select id="listPerms" resultType="string">        select distinct m.perms        from menu m        left join role_menu rm on m.menu_id = rm.menu_id        left join user_role ur on rm.role_id = ur.role_id        <where>            m.del_flag=0            <if test="userId != null and userId != ''">and ur.user_id = #{userId}</if>        </where>    </select>    <select id="selectCount" resultType="int">        select count(*)        from menu m        <where>            m.del_flag=0            <if test="menuId != null and menuId != ''">and m.menu_id != #{menuId}</if>            <if test="menuName != null and menuName != ''">and m.menu_name = #{menuName}</if>            <if test="url != null and url != ''">and m.url = #{url}</if>        </where>    </select>    <select id="listMenuByUserId" resultType="com.piglet.domain.Menu">        select DISTINCT m.menu_id as menuId,        m.parent_id as parentId,        m.menu_name as menuName,        m.url as url,        m.type as type,        m.icon as icon,        m.perms as perms        FROM menu m        left join role_menu rm on m.menu_id = rm.menu_id        left join user_role ur on rm.role_id =ur.role_id        <where>            m.del_flag=0            <if test="userId != null and userId != '' ">and ur.user_id = #{userId}</if>            <if test="type != null and type != '' ">and m.type = #{type}</if>            <if test="type == null or type == '' ">and m.type in(0,1)</if>        </where>        order by m.menu_id    </select>    <select id="menuTree" resultType="com.piglet.domain.Menu">        select DISTINCT m.menu_id as menuId,        m.parent_id as parentId,        m.menu_name as menuName,        m.url as url,        m.type as type,        m.icon as icon,        m.perms as perms,        m.create_time as createTime        FROM menu m        left join role_menu rm on m.menu_id = rm.menu_id        <where>            m.del_flag=0 and m.type in(0,1)        </where>        order by m.menu_id    </select>    <select id="findMenu" resultType="com.piglet.domain.Menu">        select m.menu_id as menuId,        m.parent_id as parentId,        m.menu_name as menuName,        m.url as url,        m.type as type,        m.icon as icon,        m.perms as perms,        m.create_time as createTime        FROM menu m        <where>            m.del_flag=0            <if test="type!=null and type!=''">and m.type = #{type}</if>        </where>    </select>    <select id="roleMenuIds" resultType="java.lang.Integer">        select rm.menu_id as menuId        FROM  role_menu rm        left join menu m on m.menu_id = rm.menu_id        <where>            m.type = 1            <if test="roleId != null and roleId != ''">and rm.role_id = #{roleId}</if>        </where>    </select>    <delete id="removeByRoleId">        DELETE  from role_menu where role_id = #{roleId}    </delete>    <insert id="saveRoleMenu">        INSERT INTO role_menu (role_id, menu_id) values        <foreach item="item" index="index" collection="list"                 separator=",">            (#{item.roleId},#{item.menuId})        </foreach>    </insert>    <update id="edit" parameterType="java.util.Map">        update menu SET        <if test="flag == 'editMenu'">menu_name = #{menuName},url = #{url},icon = #{icon},perms = #{perms}</if>        <if test="flag == 'delMenu'">del_flag = 1</if>        where menu_id = #{menuId}    </update></mapper>