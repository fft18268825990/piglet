<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.piglet.mapper.OrderMapper">	<delete id="removeAll">        DELETE o.*,mr.* FROM t_order o,month_result mr;    </delete>	<insert id="monthResult">        INSERT into month_result(        sum_amount,        sum_profit,        onemonth_amount,        onemonth_profit,        onethreemonth_amount,        onethreemonth_profit,        threesixmonth_amount,        threesixmonth_profit,        halfyearmonth_amount,        halfyearmonth_profit,        yearmonth_amount,        yearmonth_profit,        realname        )SELECT IFNULL(temp1.sum_amount,0) as sum_amount,        IFNULL(temp1.sum_profit,0) as sum_profit,        IFNULL(temp2.amount,0) as onemonth_amount,        IFNULL(temp2.profit,0) as onemonth_profit,        IFNULL(temp3.amount,0) as onethreemonth_amount,        IFNULL(temp3.profit,0) as onethreemonth_profit,        IFNULL(temp4.amount,0) as threesixmonth_amount,        IFNULL(temp4.profit,0) as threesixmonth_profit,        IFNULL(temp5.amount,0) as halfyearmonth_amount,        IFNULL(temp5.profit,0) as halfyearmonth_profit,        IFNULL(temp6.amount,0) as yearmonth_amount,        IFNULL(temp6.profit,0) as yearmonth_profit,        temp1.realname        FROM        (select SUM(o.amount) as sum_amount,SUM(o.profit) as sum_profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &gt;=  1        GROUP BY u.realname) temp1        left join        (select SUM(o.amount) as amount,SUM(o.profit) as profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) = 1        GROUP BY u.realname) temp2 on temp1.realname = temp2.realname        left join        (select SUM(o.amount) as amount,SUM(o.profit) as profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &gt; 1 and        PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &lt; 5        GROUP BY u.realname) temp3 on temp1.realname = temp3.realname        left join        (select SUM(o.amount) as amount,SUM(o.profit) as profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &gt; 4 and        PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &lt; 8        GROUP BY u.realname) temp4 on temp1.realname = temp4.realname        left join        (select SUM(o.amount) as amount,SUM(o.profit) as profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &gt; 7 and        PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &lt; 14        GROUP BY u.realname) temp5 on temp1.realname = temp5.realname        left join        (select SUM(o.amount) as amount,SUM(o.profit) as profit,u.realname as realname        from user u        left join product p on u.user_id = p.create_person        left join t_order o on p.sku = o.sku        where PERIOD_DIFF(date_format(now( ),'%Y%m'),date_format(p.create_time,'%Y%m')) &gt; 13        GROUP BY u.realname) temp6 on temp1.realname = temp6.realname    </insert>	<select id="monthResultList" resultType="java.util.Map">	select u.realname as realname,IFNULL(mr.sum_amount,0) as sum_amount,	IFNULL(mr.sum_profit,0) as sum_profit,	IFNULL(mr.onemonth_amount,0) as onemonth_amount,	IFNULL(mr.onemonth_profit,0) as onemonth_profit,	IFNULL(mr.onethreemonth_amount,0) as onethreemonth_amount,	IFNULL(mr.onethreemonth_profit,0) as onethreemonth_profit,	IFNULL(mr.threesixmonth_amount,0) as threesixmonth_amount,	IFNULL(mr.threesixmonth_profit,0) as threesixmonth_profit,	IFNULL(mr.halfyearmonth_amount,0) as halfyearmonth_amount,	IFNULL(mr.halfyearmonth_profit,0) as halfyearmonth_profit,	IFNULL(mr.yearmonth_amount,0) as yearmonth_amount,	IFNULL(mr.yearmonth_profit,0) as yearmonth_profit from user u	left join month_result mr on mr.realname = u.realname	where u.del_flag = 0	</select>	<select id="resultCount" resultType="java.lang.Integer">	select COUNT(*) from month_result	</select></mapper>